---
layout: post
title: "精确式算法：Benders 分解"
author: LJC
tags:
- OR & Algorithm
date: 2022-12-20 10:20 +0800
toc: true
---

求解混合整数规划
{: .message }

## 应用场景

Benders 分解 Benders Decomposition 求解混合整数规划问题，部分决策变量是整数（或者约束条件苛刻，与整数几乎无异），另一部分变量是实数；把服从约束条件不同的/复杂和普通的 两类变量**分开**，这在处理具有结构化特征的问题时特别有效。

**缺点**：适用性取决于问题的特性和结构。

## 算法流程

如图，X是普通变量，Y是复杂变量（如，整数），思想是如果可以把 X 这部分先定下来，然后单独研究 Y ，MP的表述如下：

- ![bd-1.png](/images/or/bd-1.png)

如果我们可以 把目标函数中含 X 的部分用 Y 表示，让带X的部分变成子问题 P3，原问题可以表述为：
- ![bd-2.png](/images/or/bd-2.png)

而所有 X 在 子问题 P3，由于P3只和 X 有关，这里的 Y 看作常数即可：
- ![bd-3.png](/images/or/bd-3.png)

对子问题 P3 ，引入对偶变量 α ，那么子问题的**对偶问题 P4** 就是：
- ![bd-4.png](/images/or/bd-4.png)

显然，子问题的对偶问题的可行域不依赖于y。根据可行域的形式，如果 P4 有解，有两种情况：
1. 无界解：对应极方向，为了防止无界，加入的对应约束为
    - ![bd-5.png](/images/or/bd-5.png)
2. 有界解：极点，对应约束为：（这里 **q 为 P4 的最优解**）
    - ![bd-6.png](/images/or/bd-6.png)

如果此时把这两个约束带回 P2 ，可以得到原问题的一个等价模型 P5：
- ![bd-7.png](/images/or/bd-7.png)

但是，模型 P5 包含大量约束（极点、极射线），因此Benders 分解不会考虑直接求解 P5 

现在，回到松弛的主问题 P2 （整数规划问题），求解不考虑 x ，只考虑y和q的的最优解 y* 和 q* ;

- 将 y* 带入 P4 求解 q(y*) ：
    - 如果 q(y*) = q*，则找到最优解
    - 如果 q(y*) >= q*，则向引入 P5 中的(c)约束进行迭代，再回到流程，求解并继续比较，直到q(y*) = q*或接近；


## 总结

Benders 分解就是将整数和实数决策变量分开考虑，实数变量通过子问题的对偶问题的解作为原问题的松弛问题的约束。通过求解松弛主问题与子问题比较后，不停迭代解